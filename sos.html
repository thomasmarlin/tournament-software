<!DOCTYPE html>
<html manifest="sos.appcache">


<!-- Third Party -->
<script src="/wp-content/plugins/swccg-tourny/js/spin.min.js.css"></script>
<script src="/wp-content/plugins/swccg-tourny/jquery-2.1.4.min.js"></script>
<script src='/wp-content/plugins/swccg-tourny/angular.1.4.8.min.js'></script>
<script src='/wp-content/plugins/swccg-tourny/angular-animate.min.js'></script>
<script src="/wp-content/plugins/swccg-tourny/js/bootstrap.min.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/angular-spinner.js"></script>
<script src="/wp-content/plugins/swccg-tourny/ui-bootstrap-tpls-1.1.0.min.js.css"></script>

<!-- Main App -->
<script src="/wp-content/plugins/swccg-tourny/sos.js"></script>

<!-- Dialog Box Controllers -->
<script src="/wp-content/plugins/swccg-tourny/js/controllers/AddPlayerController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/AssignWinnerController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/ConfirmBoxController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/CreateGameController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/CreateEventController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/EditPlayerController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/FindPlayerController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/LoadEventController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/MessageBoxController.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/controllers/PasswordPromptController.js"></script>

<!-- Services -->
<script src="/wp-content/plugins/swccg-tourny/js/services/ConstantsService.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/CryptoService.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/DataStorage.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/LocalData.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/LoggerService.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/MessageBoxService.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/RESTService.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/StatsService.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/TournamentService.js"></script>
<script src="/wp-content/plugins/swccg-tourny/js/services/UtilService.js"></script>


<!-- HTML Files -->
<script src="/wp-content/plugins/swccg-tourny/gen/confirmBoxHTML.js"></script>
<script src="/wp-content/plugins/swccg-tourny/gen/createEditGameHTML.js"></script>
<script src="/wp-content/plugins/swccg-tourny/gen/createEventHTML.js"></script>
<script src="/wp-content/plugins/swccg-tourny/gen/createPlayerHTML.js"></script>
<script src="/wp-content/plugins/swccg-tourny/gen/editPlayerHTML.js"></script>
<script src="/wp-content/plugins/swccg-tourny/gen/findPlayerHTML.js"></script>
<script src="/wp-content/plugins/swccg-tourny/gen/loadEventHTML.js"></script>
<script src="/wp-content/plugins/swccg-tourny/gen/messageBoxHTML.js"></script>
<script src="/wp-content/plugins/swccg-tourny/gen/passwordPromptHTML.js"></script>


<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/wp-content/plugins/swccg-tourny/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="/wp-content/plugins/swccg-tourny/css/sos.css">
<link rel="stylesheet" type="text/css" href="/wp-content/plugins/swccg-tourny/css/findPlayer.css">
<link rel="stylesheet" type="text/css" href="/wp-content/plugins/swccg-tourny/css/progress.css">

<div ng-app="sosApp" ng-controller="sos" style="margin:20px">

  <div class="btn-group" ng-if="currentEvent !== null" style='position:absolute; top: 10px; left: 10px'>
    <button class="btn btn-primary" data-ng-click="goHome()">&lt; Back</button>
  </div>

  <div class="btn-group" style='position:absolute; top: 10px; right: 10px'>
    <label class="btn btn-primary" ng-model="networkMode" uib-btn-radio="'NETWORK_ONLINE'" data-ng-click="toggleOnlineMode()">ONLINE</label>
    <label class="btn btn-primary" ng-model="networkMode" uib-btn-radio="'NETWORK_OFFLINE'" data-ng-click="toggleOfflineMode()">OFFLINE</label>
  </div>

  <!-- No Event yet -->
  <div ng-if="currentEvent == null" style="padding:20px">
    <div style="width:100%; text-align:center">
      <h1 class="tournamentTitle">SWCCG Tournament Assistant</h1>
    </div>

    <hr>

    <!-- Checking Network Connectivity Spinner -->
    <div ng-if="checkingNetworkStatus">
      <div class="progressBackgroundOverlay">
      </div>
      <div  class="progressPopup">
        <div class="progressCentered">
          <div us-spinner class="progressSpinner"></div>
          <div class="progressSpacer"></div>
          <h3>Checking Network Status...</h3>
        </div>
      </div>
    </div>

    <div class="row choiceContainer">

      <div style="text-align:center">
        <div>
          <button class="btn btn-primary btn-lg" ng-click="createEvent()">Create New Event</button>
          <button class="btn btn-primary btn-lg" ng-click="loadEvent()">Load Existing Event</button>
        </div>
      </div>


      <div style="margin-top: 300px; margin-left: 50px; text-align:center">
        <div style="border: thin solid #DADADA; padding: 20px">
          <div style="font-weight:bold">DEBUG TOOLS</div>

          <div>
            <button class="btn btn-info" ng-click="loadEventFromFile()">DEBUG: Load File</button>
            <button class="btn btn-danger" ng-click="clearAllData()">DEBUG: Clear All Data</button>
            <input style="display:none" type='file' id='fileinput'>
          </div>
        </div>

      </div>

    </div>

  </div>


  <!-- Event Loaded! -->
  <div ng-if="currentEvent != null">

    <h1 class="tournamentTitle">{{currentEvent.name}}</h1>

    <hr>

    <!-- Players -->
    <div class="mainContentBox">
      <div class="mainContentHeader">
        <h2 class="mainContentHeaderName">Players</h2>
        <div class="mainContentHeaderButtons">
          <button class="btn btn-default" style="float:right;" data-ng-click="addPlayer()">Add Player</button>
        </div>
      </div>

      <hr>

      <div ng-if="currentEvent.players.length == 0" style="margin:50px">
        <h3 style="font-style:italic; color:gray">Click 'Add Player' to add players...</h3>
      </div>

      <div ng-if="currentEvent.players.length > 0">
        <!-- Headers -->
        <div ng-repeat="player in currentEvent.players | orderBy:['-vp', '-sos']"
             class="playerBox"
             ng-class="{'droppedPlayer': player.status === 'STATUS_DROPPED' }">
          <div style="margin:10px">
            <div class="row">

              <div class="col-xs-2">
                <div class="glyphicon glyphicon-user" style="font-size: 2.5em; margin-left: 9px"></div>
                <div style="color:blue; text-decoration:underline; margin-left: 5px;" ng-click="editPlayer(player)">Update</div>
              </div>

              <div class="col-xs-4">
                <div class="playerBoxHeader">{{player.name}}</div>
                <div ng-if='player.forum_handle' class="swccg_forum_handle">{{player.forum_handle}}</div>
                <div>SoS: {{player.sos}}</div>
                <div>Diff:
                  <span ng-if="player.diff >= 0" style="color:green"> ({{player.diff}}) </span>
                  <span ng-if="player.diff < 0" style="color:red"> ({{player.diff}}) </span>
                </div>
              </div>

              <div class="col-xs-4">
                <div class="playerBoxHeader">Victory Points: {{player.vp}}</div>
                <div>Record: {{player.wins}}-{{player.losses}}</div>
                <div>Status: {{player.status == 'STATUS_ACTIVE' ? 'Active' : 'DROPPED' }}</div>
              </div>

              <div class="col-xs-2">
                <div style="color:red; position:absolute; right: 20px; top: 11px; font-size:1.5em;" ng-click="deletePlayer(player)" class="glyphicon glyphicon-remove"></div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>

    <hr>

    <!-- Games -->
    <div class="mainContentBox">
      <div class="mainContentHeader">
        <h2 class="mainContentHeaderName">Games</h2>
        <div class="mainContentHeaderButtons">
          <button class="btn btn-default" style="float:right" data-ng-click="newRound()">New Round</button>
          <button data-ng-if="currentEvent.rounds.length > 0" class="btn btn-default" style="float:right; margin-right:20px" data-ng-click="createGame()">Create Game</button>
          <button data-ng-if="currentEvent.rounds.length > 0" class="btn btn-default" style="float:right; margin-right:20px" data-ng-click="deleteRound()">Delete Round</button>
          <div style="clear:both"></div>
        </div>
      </div>

      <hr>

      <uib-tabset>
        <uib-tab active='round.active'
              heading='Round {{round.num}}'
              ng-repeat='round in currentEvent.rounds'>

            <div ng-if="currentEvent.games.length == 0" style="margin:50px">
              <h3 style="font-style:italic; color:gray">Click 'Create Game' to add a new game...</h3>
            </div>

            <div ng-if="currentEvent.games.length > 0">
              <!-- Headers -->
              <div style="margin-left:20px; margin-right:20px">
                <div class="row" >
                    <div class="col-xs-6">
                      <h5>Players</h5>
                    </div>
                    <div class="col-xs-6">
                      <h5>Winner</h5>
                    </div>
                </div>
              </div>

              <div ng-repeat="game in currentEvent.games" style="margin-left:20px; margin-right:20px" ng-show='game.round.num == round.num'>

                <div>

                  <!-- Games Table -->
                  <div class="row playerBox" ng-class="{'gameFinished': game.winner, 'gamePending': !game.winner }">

                      <div class="col-xs-6" style="margin-top:5px">
                          <div>Dark: <span style="font-weight:bold">{{game.playerDark.name}}</span><span style="margin-left:10px; height: 10px; width: 10px"></span>{{getPlayerRecord(game.playerDark)}}</div>
                          <div>Light: <span style="font-weight:bold">{{game.playerLight.name}}</span><span style="margin-left:10px; height: 10px; width: 10px"></span>{{getPlayerRecord(game.playerLight)}}</div>
                      </div>
                      <div class="col-xs-6" style="margin-top:5px">

                          <div ng-if="game.winner">
                              <div>{{game.winner.name}}
                                <span ng-if='currentEvent.mode !== "SOS"' style="margin-left: 5px"> (+{{game.diff}})</span>
                              </div>
                              <button class="btn btn-default" ng-click="addResult(game)">Change</button>
                              <div style="color:red; position:absolute; right: 20px; top: 11px; font-size:1.5em;" ng-click="deleteGame(game)" class="glyphicon glyphicon-remove"></div>
                          </div>

                          <div ng-if="!game.winner">
                              <button class="btn btn-default" ng-click="addResult(game)">Add Result</button>
                              <div style="color:red; position:absolute; right: 20px; top: 11px; font-size:1.5em;" ng-click="deleteGame(game)" class="glyphicon glyphicon-remove"></div>
                          </div>

                      </div>
                  </div>
                </div>

              </div>

        </uib-tab>
      </uib-tabs>
    </div>

  </div>

  <hr>


  <div style="margin-top:20px">
    <div class="debugToolsLabel">Debug Tools</div>
    <button class="btn btn-success rightFloatButtons" data-ng-click="saveData()">Save Data</button>
    <button class="btn btn-success rightFloatButtons" data-ng-click="exportData()">Export Data</button>
    <div style="clear:both"></div>
  </div>

</div>
</html>
